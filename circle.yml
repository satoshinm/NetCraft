machine:
    environment:
        EMSCRIPTEN: /usr/share/emscripten

dependencies:
    pre:
        - sudo apt-get install emscripten
        - emcc
        - ls -l /usr/share/emscripten/cmake/Modules/Platform/Emscripten.cmake
        - ls -l /usr/share/emscripten/
        - mkdir release-build-js
        - cd release-build-js && cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_TOOLCHAIN_FILE=$EMSCRIPTEN/cmake/Modules/Platform/Emscripten.cmake ..
        - sudo apt-get install cmake libglew-dev xorg-dev libcurl4-openssl-dev
        - sudo apt-get install libglfw-dev
        - mkdir native-build
        - cd native-build && cmake ..
test:
    override:
        - cd native-build && make
        - cd release-build-js && make
general:
    artifacts:
        - "native-build/craft"
        - "native-build/textures"
        - "native-build/shaders"
